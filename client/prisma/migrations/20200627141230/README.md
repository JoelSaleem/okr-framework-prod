# Migration `20200627141230`

This migration has been generated by JoelSaleem at 6/27/2020, 2:12:30 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Objective" (
"createdAt" timestamp(3)  NOT NULL ,"description" text   ,"id" SERIAL,"parentId" integer   ,"title" text  NOT NULL ,"userId" integer  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."KeyResult" (
"createdAt" timestamp(3)  NOT NULL ,"current" integer  NOT NULL ,"description" text   ,"id" SERIAL,"objectiveId" integer   ,"target" integer  NOT NULL ,"title" text  NOT NULL ,"userId" integer  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."User" (
"createdAt" timestamp(3)  NOT NULL ,"email" text  NOT NULL ,"id" SERIAL,"password" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

ALTER TABLE "public"."Objective" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Objective" ADD FOREIGN KEY ("parentId")REFERENCES "public"."Objective"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."KeyResult" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."KeyResult" ADD FOREIGN KEY ("objectiveId")REFERENCES "public"."Objective"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200627141230
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,48 @@
+datasource postgres {
+  provider = "postgres"
+  url = "***"
+}
+
+// This "Example" model has been generated for you by Nexus.
+// Nexus does this when you do not have any models defined.
+// For more detail and examples of working with your Prisma
+// Schema, refer to its complete docs at https://pris.ly/d/prisma-schema.
+
+model Objective {
+  id              Int         @id @default(autoincrement())
+  title           String
+  description     String?
+  createdAt       DateTime
+  user            User        @relation(fields: [userId], references: [id])
+  userId          Int
+  keyResults      KeyResult[]
+  parentObjective Objective?  @relation(fields: [parentId], references: id)
+  parentId        Int?
+  Objective       Objective[] @relation("ObjectiveToObjective")
+}
+
+model KeyResult {
+  id          Int        @id @default(autoincrement())
+  title       String
+  description String?
+  createdAt   DateTime
+  target      Int
+  current     Int
+  user        User       @relation(fields: [userId], references: [id])
+  userId      Int
+  objective   Objective? @relation(fields: [objectiveId], references: [id])
+  objectiveId Int?
+}
+
+model User {
+  id         Int         @id @default(autoincrement())
+  email      String      @unique
+  password   String
+  objectives Objective[]
+  createdAt  DateTime
+  KeyResult  KeyResult[]
+}
+
+generator prisma_client {
+  provider = "prisma-client-js"
+}
```


